{% extends 'dashboard/base.html' %}
{% block title %}{{ project.name }}{% endblock %}
{% block content %}
<h1>{{ project.name }}</h1>
<div class="row mb-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Total Billable</h5>
                <p class="card-text">${{ total_billable }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Total Payments</h5>
                <p class="card-text">${{ total_payments }}</p>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Outstanding</h5>
                <p class="card-text">${{ outstanding }}</p>
            </div>
        </div>
    </div>
</div>
<a href="{% url 'dashboard:customer_report' project.pk %}" class="btn btn-secondary mb-3">Customer Report</a>
<a href="{% url 'dashboard:contractor_job_report' project.pk %}" class="btn btn-secondary mb-3 ms-2">Contractor Job Report</a>
<h2>Job Entries</h2>
<a href="{% url 'dashboard:add_job_entry' project.pk %}" class="btn btn-primary mb-2">Add Job Entry</a>
<div class="table-responsive mb-4">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Date</th>
                <th>Hours / Qty</th>
                <th>Asset</th>
                <th>Employee</th>
                <th>Material Description</th>
                <th>Material Cost</th>
                <th>Cost Amount</th>
                <th>Billable Amount</th>
                <th>Description</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
        {% for entry in job_entries %}
            <tr>
                <td>{{ entry.date }}</td>
                <td>{{ entry.hours }}</td>
                <td>{{ entry.asset }}</td>
                <td>{{ entry.employee }}</td>
                <td>{{ entry.material_description }}</td>
                <td>{% if entry.material_cost %}${{ entry.material_cost }}{% endif %}</td>
                <td>${{ entry.cost_amount }}</td>
                <td>${{ entry.billable_amount }}</td>
                <td>{{ entry.description }}</td>
                <td><a href="{% url 'dashboard:edit_job_entry' entry.pk %}" class="btn btn-sm btn-secondary">Edit</a></td>
            </tr>
        {% empty %}
            <tr><td colspan="10">No job entries.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>
<h2>Payments</h2>
<a href="{% url 'dashboard:add_payment' project.pk %}" class="btn btn-primary mb-2">Add Payment</a>
<div class="table-responsive">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Date</th>
                <th>Amount</th>
                <th>Notes</th>
            </tr>
        </thead>
        <tbody>
        {% for payment in payments %}
            <tr>
                <td>{{ payment.date }}</td>
                <td>${{ payment.amount }}</td>
                <td>{{ payment.notes }}</td>
            </tr>
        {% empty %}
            <tr><td colspan="3">No payments.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
